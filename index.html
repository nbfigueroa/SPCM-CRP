<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Spectral Polytope Covariance Matrix - Chinese Restaurant Process (SPCM-CRP) : Non-parametric clustering of transformed Covariance matrices.">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Spectral Polytope Covariance Matrix - Chinese Restaurant Process (SPCM-CRP)</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/nbfigueroa/SPCM-CRP">View on GitHub</a>

          <h1 id="project_title">Spectral Polytope Covariance Matrix - Chinese Restaurant Process (SPCM-CRP)</h1>
          <h2 id="project_tagline">Non-parametric clustering of transformed Covariance matrices.</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/nbfigueroa/SPCM-CRP/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/nbfigueroa/SPCM-CRP/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a id="spcm-crp" class="anchor" href="#spcm-crp" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>SPCM-CRP</h1>

<p>SPCM-CRP : Transform Invariant Chinese Restaurant Process for Covariance Matrices<br>
Website: <a href="http://nbfigueroa.github.io/SPCM-CRP/">http://nbfigueroa.github.io/SPCM-CRP/</a><br>
Author: Nadia Figueroa (nadia.figueroafernandez AT epfl.ch)</p>

<p>This repo provides code for running the Non-parametric Spectral Clustering algorithm on Covariance Matrix Datasets (SPCM-CRP) introduced in [1]. In a nutshell, <strong>SPCM-CRP</strong> is a similarity-dependent Chinese Restaurant process. Where the similarity matrix comes from the Spectral Polytope Covariance Matrix Similarity function and the non-parametric clustering is applied on the spectral manifold of the similarity function.</p>

<h3>
<a id="illustrative-example" class="anchor" href="#illustrative-example" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Illustrative Example</h3>

<p>To highlight the power of the proposed method, we consider a dataset of 5 Covariance Matrices of 3-dimensions, which can be illustrated as ellipsoids in 3D space:</p>

<p align="center">
<img src="https://github.com/nbfigueroa/SPCM-CRP/blob/master/img/3d-ellipsoids.png" width="700">
</p>

<p>The dataset is generated by <strong>two distinct Covariance matrices</strong> which are randomly transformed (rotation, scale, noise). The similar matrices are depicted by the colors of their ellipsoids.</p>

<p><strong>Our goal</strong> is to cluster this dataset with a transform-invariant metric that will give us the two expected clusters.</p>

<h3>
<a id="spectral-polytope-covariance-matrix-spcm-similarity-function" class="anchor" href="#spectral-polytope-covariance-matrix-spcm-similarity-function" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Spectral Polytope Covariance Matrix (SPCM) Similarity Function</h3>

<p>Seldom Covariance Matrix similarity functions explictly have the property of transform-invariance. In this work, I propose such a similarity function which uses the idea of a <strong>Spectral Polytope</strong> together with the concept of <strong>homothety</strong>.</p>

<p align="center">
<img src="https://github.com/nbfigueroa/SPCM-CRP/blob/master/img/sigmas_mod.png" width="700">
</p>

<p>The <strong>Spectral Polytope (SP)</strong> is the Convex envelope of the projection of the Eigenvectors scaled by their Eigenvalues (X). The idea is, if the SPs of two covariance matrices have the same shape but are scaled by some homothetic factor, then they are similar (Refer to [1] for the math). By implementing this simple, yet elegant idea, we get robust transform-invariant similarity values (second plot is the B-SPCM - a bounded version of SPCM):</p>

<p align="center">
<img src="https://github.com/nbfigueroa/SPCM-CRP/blob/master/img/SPCM.png" width="300"><img src="https://github.com/nbfigueroa/SPCM-CRP/blob/master/img/BSPCM.png" width="300">
</p>

<p>which are not well recovered by other metrics (RIEM, LERM, KLDM, JBLD):</p>

<p align="center">
<img src="https://github.com/nbfigueroa/SPCM-CRP/blob/master/img/RIEM.png" width="200"><img src="https://github.com/nbfigueroa/SPCM-CRP/blob/master/img/LERM.png" width="200"><img src="https://github.com/nbfigueroa/SPCM-CRP/blob/master/img/KLDM.png" width="200"><img src="https://github.com/nbfigueroa/SPCM-CRP/blob/master/img/JBLD.png" width="200">
</p>

<ul>
<li>RIEM: Affine Invariant Riemannian Metric</li>
<li>LERM: Log-Euclidean Riemannian Metric</li>
<li>KLDM: Kullback-Liebler Divergence Metric</li>
<li>JBLD: Jensen-Bregman LogDet Divergence</li>
</ul>

<h3>
<a id="similarity-based-non-parametric-clustering-sd---chinese-restaurant-process" class="anchor" href="#similarity-based-non-parametric-clustering-sd---chinese-restaurant-process" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Similarity-based Non-parametric clustering (sd - Chinese Restaurant Process)</h3>

<p>Now that we have a good similarity function for our task, we want to derive a clustering mechanism that is free of model selection and robust to intializations. Thus, we choose a variant of the Chinese Resturant Process, namely the <strong>sd-CRP</strong> [2] whose priors for cluster assigment are driven by the similarity values and the data is clustered on the Spectral Manifold of the Similarity matrix of the Dataset.</p>

<h4>
<a id="sd-crp-steps" class="anchor" href="#sd-crp-steps" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>sd-CRP steps</h4>

<ul>
<li>
<p>Initially, we apply an <strong>augmented Spectral Dimenensionality</strong> [1] reduction algorithm, which automatically selects the dimensionality of the Spectral Manifold by applying a SoftMax on the Eigenvalues of the Laplacian of the Similarity matrix:</p>

<p align="center">
<img src="https://github.com/nbfigueroa/SPCM-CRP/blob/master/img/auto-spectral-manifold.png" width="500">
</p>
</li>
<li>
<p>Once we have the points on the Spectral Manifold corresponding to each Covariance Matrix, we apply the <strong>sd-CRP</strong>. Which follows the analogy for seating customers in a Chinese Restaurant with infinite number of tables wrt. a similarity between the customers</p>

<p align="center">
<img src="https://github.com/nbfigueroa/SPCM-CRP/blob/master/img/ddcrp.png" width="500">
</p>

<p>Each customer chooses to sit with another customer or alone according to a prior dependent on the <strong>SPCM similarity function</strong>. Table assignments z(c), then emerge from linked customers or cycles, regardless of sequence or ordering.</p>
</li>
</ul>

<p>To run the full SPCM-CRP pipeline, follow the scipt <code>demo_sdCRP.m</code>, for the 3D dataset you should get the following output on your MATLAB terminal:</p>

<pre><code>Clustering via sd-CRP...
*** Initialized with 5 clusters out of 5 observations ***
Iteration 1: Started with 5 clusters --&gt; moved to 3 clusters with logprob = -23.35
Iteration 2: Started with 3 clusters --&gt; moved to 2 clusters with logprob = -22.03
Iteration 3: Started with 2 clusters --&gt; moved to 2 clusters with logprob = -22.03
Iteration 4: Started with 2 clusters --&gt; moved to 2 clusters with logprob = -22.57
Iteration 5: Started with 2 clusters --&gt; moved to 3 clusters with logprob = -23.91
Iteration 6: Started with 3 clusters --&gt; moved to 2 clusters with logprob = -22.22
Iteration 7: Started with 2 clusters --&gt; moved to 2 clusters with logprob = -22.57
Iteration 8: Started with 2 clusters --&gt; moved to 2 clusters with logprob = -21.68
Iteration 9: Started with 2 clusters --&gt; moved to 3 clusters with logprob = -23.89
Iteration 10: Started with 3 clusters --&gt; moved to 2 clusters with logprob = -21.68
Iteration 11: Started with 2 clusters --&gt; moved to 2 clusters with logprob = -22.25
Iteration 12: Started with 2 clusters --&gt; moved to 3 clusters with logprob = -23.04
Iteration 13: Started with 3 clusters --&gt; moved to 2 clusters with logprob = -22.22
Iteration 14: Started with 2 clusters --&gt; moved to 2 clusters with logprob = -22.59
Iteration 15: Started with 2 clusters --&gt; moved to 2 clusters with logprob = -22.59
Iteration 16: Started with 2 clusters --&gt; moved to 2 clusters with logprob = -22.25
Iteration 17: Started with 2 clusters --&gt; moved to 2 clusters with logprob = -22.03
Iteration 18: Started with 2 clusters --&gt; moved to 3 clusters with logprob = -23.61
Iteration 19: Started with 3 clusters --&gt; moved to 2 clusters with logprob = -22.25
Iteration 20: Started with 2 clusters --&gt; moved to 2 clusters with logprob = -21.68
Elapsed time is 0.179722 seconds.
MAP Cluster estimate recovered at iter 8: 2
sd-CRP LP: -2.168154e+01 and Purity: 1.00, NMI Score: 1.00, F measure: 1.00 
*************************************************************
</code></pre>

<p>The result is:</p>

<p></p><p align="center">
  <img src="https://github.com/nbfigueroa/SPCM-CRP/blob/master/img/sdCRP_results.png" width="500">
  </p>

<p><strong>without</strong> selecting or optimizing for <strong>ANY</strong> hyper-parameters.</p>

<h3>
<a id="comparisons" class="anchor" href="#comparisons" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Comparisons</h3>

<ul>
<li>
<p>In `<code>demo_comparisons.m</code> I provide extensive comparisons between the SPCM similarity function and the 4 other standard Covariance Matrix Similarity functions used in literature for datasets of increasing dimensionality and samples [1], for example a 6D Covariance matrix dataset with 30 samples are well discriminated with SPCM and B-SPCM:</p>

<p align="center">
<img src="https://github.com/nbfigueroa/SPCM-CRP/blob/master/img/SPCM_30.png" width="300"><img src="https://github.com/nbfigueroa/SPCM-CRP/blob/master/img/BSPCM_30.png" width="300">
</p>

<p>while the othe functions (RIEM, LERM, KLDM, JBLD) do not show apparent partitions to the naked eye:</p>

<p align="center">
<img src="https://github.com/nbfigueroa/SPCM-CRP/blob/master/img/RIEM_30.png" width="200"><img src="https://github.com/nbfigueroa/SPCM-CRP/blob/master/img/LERM_30.png" width="200"><img src="https://github.com/nbfigueroa/SPCM-CRP/blob/master/img/KLDM_30.png" width="200"><img src="https://github.com/nbfigueroa/SPCM-CRP/blob/master/img/JBLD_30.png" width="200">
</p>
</li>
<li><p>Also, you can compare the SPCM-CRP to standard Similarity-based clustering algorithms like Affinity Propapgation and Spectral Clustering with k-means [1].</p></li>
</ul>

<h4>
<a id="dependencies" class="anchor" href="#dependencies" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Dependencies</h4>

<p>To run the <strong>comparisons</strong> demo, download the following toolbox and make sure to have it in your MATLAB path:</p>

<ul>
<li>
<a href="https://github.com/epfl-lasa/ML_toolbox">ML_toolbox</a>: Machine learning toolbox containing a plethora of dimensionality reduction, clustering, classification and regression algorithms accompanying the <a href="http://lasa.epfl.ch/teaching/lectures/ML_MSc_Advanced/index.php">Advanced Machine Learning</a> course imparted at EPFL by Prof. Aude Billard.</li>
</ul>

<p>If you're not interested in running comparisons, this step is not needed.</p>

<h3>
<a id="publication" class="anchor" href="#publication" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Publication</h3>

<p>[1] Nadia Figueroa and Aude Billard, "Transform Invariant Discovery of Dynamical Primitives: Leveraging Spectral and Bayesian Non-parametric Methods." <em>In preparation</em>.<br>
[2] Richard Socher, Andrew Maas and Christopher D. Manning. "Spectral Chinese Restaurant Processes: Nonparametric Clustering
Based on Similarities" In proceedings of th 14th International Conference on Artificial Intelligence and Statistics (AISTATS), 2011.</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Spectral Polytope Covariance Matrix - Chinese Restaurant Process (SPCM-CRP) maintained by <a href="https://github.com/nbfigueroa">nbfigueroa</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
